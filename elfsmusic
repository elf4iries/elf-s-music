-- youtube_music.lua
local basalt = require("basalt")
local speaker = peripheral.find("speaker")

if not speaker then
    error("Speaker nao encontrado!")
end

local searchResults = {}
local isPlaying = false
local isPaused = false
local audioResponse = nil

local SEARCH_API = "https://music.madefor.cc/search"
local CONVERTER_API = "https://music.madefor.cc/api/convert"

local c = {
    bg = colors.black,
    dark = colors.blue,
    med = colors.lightBlue,
    light = colors.cyan,
    white = colors.white,
    purple = colors.purple,
}

local main = basalt.createFrame()
main:setBackground(c.bg)

local searchFrame = main:addFrame()
searchFrame:setPosition(1, 1)
searchFrame:setSize("parent.w", "parent.h")
searchFrame:setBackground(c.bg)

local header = searchFrame:addLabel()
header:setText("YOUTUBE MUSIC PLAYER")
header:setPosition("center", 2)
header:setForeground(c.white)

local subtitle = searchFrame:addLabel()
subtitle:setText("Digite a musica:")
subtitle:setPosition(3, 5)
subtitle:setForeground(c.light)

local searchInput = searchFrame:addInput()
searchInput:setPosition(3, 6)
searchInput:setSize("parent.w - 4", 3)
searchInput:setBackground(c.dark)
searchInput:setForeground(c.white)

local searchButton = searchFrame:addButton()
searchButton:setText("BUSCAR")
searchButton:setPosition(3, 10)
searchButton:setSize(15, 3)
searchButton:setBackground(c.med)
searchButton:setForeground(c.bg)

local statusLabel = searchFrame:addLabel()
statusLabel:setText("")
statusLabel:setPosition(20, 11)
statusLabel:setForeground(c.light)

local resultsLabel = searchFrame:addLabel()
resultsLabel:setText("Resultados:")
resultsLabel:setPosition(3, 14)
resultsLabel:setForeground(c.purple)

local resultsList = searchFrame:addList()
resultsList:setPosition(3, 15)
resultsList:setSize("parent.w - 4", "parent.h - 15")
resultsList:setBackground(c.dark)
resultsList:setForeground(c.white)

resultsLabel:setVisible(false)
resultsList:setVisible(false)

local playerFrame = main:addFrame()
playerFrame:setPosition(1, 1)
playerFrame:setSize("parent.w", "parent.h")
playerFrame:setBackground(c.bg)
playerFrame:setVisible(false)

local playerHeader = playerFrame:addLabel()
playerHeader:setText("TOCANDO AGORA")
playerHeader:setPosition("center", 2)
playerHeader:setForeground(c.light)

local playerTitle = playerFrame:addLabel()
playerTitle:setText("")
playerTitle:setPosition(3, 5)
playerTitle:setForeground(c.white)

local playerArtist = playerFrame:addLabel()
playerArtist:setText("")
playerArtist:setPosition(3, 6)
playerArtist:setForeground(c.light)

local playerStatus = playerFrame:addLabel()
playerStatus:setText("")
playerStatus:setPosition(3, 8)
playerStatus:setForeground(c.purple)

local progressBar = playerFrame:addProgressbar()
progressBar:setPosition(3, 10)
progressBar:setSize("parent.w - 4", 1)
progressBar:setProgress(0)
progressBar:setProgressBar(c.med)
progressBar:setBackground(c.dark)

local progressText = playerFrame:addLabel()
progressText:setText("0%")
progressText:setPos
